{% extends 'base.html' %}

{% block title %}Reports - Dairy Management System{% endblock %}

{% block content %}
<h1>Reports & Analytics</h1>

<div class="grid" style="margin: 2rem 0;">
    <div class="stat-card">
        <h3>Total Orders</h3>
        <div class="value">{{ orders|length }}</div>
    </div>
    
    <div class="stat-card">
        <h3>Total Revenue</h3>
        <div class="value">₹{{ orders|map(attribute='total_amount')|sum }}</div>
    </div>
    
    <div class="stat-card">
        <h3>Total Products</h3>
        <div class="value">{{ products|length }}</div>
    </div>
    
    <div class="stat-card">
        <h3>Low Stock Items</h3>
        <div class="value">{{ products|selectattr('stock', 'lt', 10)|list|length }}</div>
    </div>
</div>

<div class="card">
    <h2>Daily Sales Report</h2>
    
    {% if daily_sales %}
    <table class="table">
        <thead>
            <tr>
                <th>Date</th>
                <th>Sales</th>
            </tr>
        </thead>
        <tbody>
            {% for date, amount in daily_sales|dictsort|reverse %}
            <tr>
                <td>{{ date.strftime('%d-%m-%Y') }}</td>
                <td>₹{{ amount }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>No sales data yet.</p>
    {% endif %}
</div>

<div class="card">
    <h2>Product Inventory</h2>
    
    <table class="table">
        <thead>
            <tr>
                <th>Product</th>
                <th>Stock</th>
                <th>Unit</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            {% for product in products %}
            <tr>
                <td>{{ product.name }}</td>
                <td>{{ product.stock }}</td>
                <td>{{ product.unit }}</td>
                <td>
                    {% if product.stock < 5 %}
                        <span style="padding: 0.25rem 0.75rem; border-radius: 0.25rem; background-color: #f8d7da; color: #721c24;">Low Stock</span>
                    {% elif product.stock < 10 %}
                        <span style="padding: 0.25rem 0.75rem; border-radius: 0.25rem; background-color: #fff3cd; color: #856404;">Medium Stock</span>
                    {% else %}
                        <span style="padding: 0.25rem 0.75rem; border-radius: 0.25rem; background-color: #d4edda; color: #155724;">Good Stock</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
